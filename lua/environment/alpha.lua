local M = {}

function M.animation_line_replace(line, replace, replace_with, frequency)
  return string.gsub(line, replace, function(c)
    local prob = math.random()
    if prob <= frequency then
      return replace_with
    end
    return c
  end)
end

--- generates a series of similarly styled frames containing mostly the same
--- text with a few random modifications repeated over several frames, this way
--- we can pass to the veil's animate function easily and get a nice looking
--- header.
---@param base_frame table a collection of strings as line items in a table
---which together forms the full base splash image to use.
---@param opts table options that describe how the animation generation should
---proceed. Valid field of the opts table are:
---1. replace_char string|string[] the substrings that should be randomly
---replaced with...
---2. replace_with string|string[] the substrings that should replace the above
---characters to be replaced.
---3. frequency float(0,1) a proportion representing the frequency of which the
---replace_char is replaced with one of the options from replace_with.
function M.generate_animation_frame(base_frame, opts)
  opts = opts or {}
  local replace = opts.replace_char or { [[.]] }
  local replace_with = opts.replace_with or { [[*]] }
  local frequency = opts.frequency or { 0.05 } --5% replacement
  local res = {}
  for no, line in pairs(base_frame) do
    res[no] = M.animation_line_replace(line, replace, replace_with, frequency)
  end
  return res
end

function M.generate_animation(base_frame, opts)
  local n_repeat = opts.n_frame
  local res = {}
  for i = 1, n_repeat, 1 do
    res[i] = M.generate_animation_frame(base_frame, opts)
  end
  return res
end

M.nightowl_splash_compact = {
  [[..................................................................................]],
  [[..................................................................................]],
  [[...███╗...██╗██╗.██████╗.██╗..██╗████████╗.██████╗.██╗....██╗██╗..................]],
  [[...████╗..██║██║██╔════╝.██║..██║╚══██╔══╝██╔═══██╗██║....██║██║..................]],
  [[...██╔██╗.██║██║██║..███╗███████║...██║...██║...██║██║.█╗.██║██║█████╗█████╗......]],
  [[...██║╚██╗██║██║██║...██║██╔══██║...██║...██║...██║██║███╗██║██║╚════╝╚════╝......]],
  [[...██║.╚████║██║╚██████╔╝██║..██║...██║...╚██████╔╝╚███╔███╔╝███████╗███████╗.....]],
  [[...╚═╝..╚═══╝╚═╝.╚═════╝.╚═╝..╚═╝...╚═╝....╚═════╝..╚══╝╚══╝.╚══════╝╚══════╝.....]],
  [[...invisible ...... are ... only .............███╗...██╗██╗...██╗██╗███╗...███╗...]],
  [[..............things....the......realities....████╗..██║██║...██║██║████╗.████║...]],
  [[...█████╗█████╗█████╗█████╗█████╗█████╗█████╗.██╔██╗.██║██║...██║██║██╔████╔██║...]],
  [[...╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝.██║╚██╗██║╚██╗.██╔╝██║██║╚██╔╝██║...]],
  [[...███████╗███████╗███████╗███████╗███████╗█████║.╚████║.╚████╔╝.██║██║.╚═╝.██║...]],
  [[...╚══════╝╚══════╝╚══════╝╚══════╝╚══════╝╚════╝..╚═══╝..╚═══╝..╚═╝╚═╝.....╚═╝...]],
  [[..................................................................................]],
  [[............___.........___.....---...---..............---....---.................]],
  [[...........<O,O>.......<Q,Q>...{O,O}.{O,O}.............0⌵0>..<0⌵0>................]],
  [[...........[`&'].......[`&']...[`%'].[`%']............[`8']..[`8']................]],
  [[============"="========="="====="="==="="=============="="===="="=================]],
  [[..................................................................................]],
}
M.nightowl_splash = {
  [[..............................................................................................................]],
  [[..............................................................................................................]],
  [[.....███╗...██╗██╗.██████╗.██╗..██╗████████╗.██████╗.██╗....██╗██╗............................................]],
  [[.....████╗..██║██║██╔════╝.██║..██║╚══██╔══╝██╔═══██╗██║....██║██║............................................]],
  [[.....██╔██╗.██║██║██║..███╗███████║...██║...██║...██║██║.█╗.██║██║█████╗█████╗█████╗█████╗█████╗█████╗........]],
  [[.....██║╚██╗██║██║██║...██║██╔══██║...██║...██║...██║██║███╗██║██║╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝........]],
  [[.....██║.╚████║██║╚██████╔╝██║..██║...██║...╚██████╔╝╚███╔███╔╝███████╗███████╗███████╗███████╗███████╗.......]],
  [[.....╚═╝..╚═══╝╚═╝.╚═════╝.╚═╝..╚═╝...╚═╝....╚═════╝..╚══╝╚══╝.╚══════╝╚══════╝╚══════╝╚══════╝╚══════╝.......]],
  [[.....invisible ...... are ... only .....................................███╗...██╗██╗...██╗██╗███╗...███╗.....]],
  [[................things....the......realities............................████╗..██║██║...██║██║████╗.████║.....]],
  [[.....█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗.██╔██╗.██║██║...██║██║██╔████╔██║.....]],
  [[.....╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝.██║╚██╗██║╚██╗.██╔╝██║██║╚██╔╝██║.....]],
  [[.....███████╗███████╗███████╗███████╗███████╗███████╗███████╗███████╗██╗██║.╚████║.╚████╔╝.██║██║.╚═╝.██║.....]],
  [[.....╚══════╝╚══════╝╚══════╝╚══════╝╚══════╝╚══════╝╚══════╝╚══════╝╚═╝╚═╝..╚═══╝..╚═══╝..╚═╝╚═╝.....╚═╝.....]],
  [[..............................................................................................................]],
  [[..............___.........___.....---...---..............................---....---...........................]],
  [[.............<O,O>.......<Q,Q>...{O,O}.{O,O}............................<0⌵0>..<0⌵0>..........................]],
  [[.............[`&'].......[`&']...[`%'].[`%']............................[`8']..[`8']..........................]],
  [[=============="="========="="====="="==="="=============================="="===="="===========================]],
  [[..............................................................................................................]],
}
M.nightowl_splash_frames = M.generate_animation(M.nightowl_splash, {
  n_frame = 10,
  replace_char = "%.",
  replace_with = "*",
  frequency = 0.05,
})

M.nightowl_splash_compact_frames =
  M.generate_animation(M.nightowl_splash_compact, {
    n_frame = 10,
    replace_char = "%.",
    replace_with = "*",
    frequency = 0.05,
  })

M.week_headers = {
  monday = {

    [[        _   _         _            _             _            _    _        _  ]],
    [[       /\_\/\_\ _    /\ \         /\ \     _    /\ \         / /\ /\ \     /\_\]],
    [[      / / / / //\_\ /  \ \       /  \ \   /\_\ /  \ \____   / /  \\ \ \   / / /]],
    [[     /\ \/ \ \/ / // /\ \ \     / /\ \ \_/ / // /\ \_____\ / / /\ \\ \ \_/ / / ]],
    [[    /  \____\__/ // / /\ \ \   / / /\ \___/ // / /\/___  // / /\ \ \\ \___/ /  ]],
    [[   / /\/________// / /  \ \_\ / / /  \/____// / /   / / // / /  \ \ \\ \ \_/   ]],
    [[  / / /\/_// / // / /   / / // / /    / / // / /   / / // / /___/ /\ \\ \ \    ]],
    [[ / / /    / / // / /   / / // / /    / / // / /   / / // / /_____/ /\ \\ \ \   ]],
    [[/ / /    / / // / /___/ / // / /    / / / \ \ \__/ / // /_________/\ \ \\ \ \  ]],
    [[\/_/    / / // / /____\/ // / /    / / /   \ \___\/ // / /_       __\ \_\\ \_\ ]],
    [[        \/_/ \/_________/ \/_/     \/_/     \/_____/ \_\___\     /____/_/ \/_/ ]],
  },
  tuesday = {
    [[        _   _         _            _             _            _    _        _  ]],
    [[       /\_\/\_\ _    /\ \         /\ \     _    /\ \         / /\ /\ \     /\_\]],
    [[      / / / / //\_\ /  \ \       /  \ \   /\_\ /  \ \____   / /  \\ \ \   / / /]],
    [[     /\ \/ \ \/ / // /\ \ \     / /\ \ \_/ / // /\ \_____\ / / /\ \\ \ \_/ / / ]],
    [[    /  \____\__/ // / /\ \ \   / / /\ \___/ // / /\/___  // / /\ \ \\ \___/ /  ]],
    [[   / /\/________// / /  \ \_\ / / /  \/____// / /   / / // / /  \ \ \\ \ \_/   ]],
    [[  / / /\/_// / // / /   / / // / /    / / // / /   / / // / /___/ /\ \\ \ \    ]],
    [[ / / /    / / // / /   / / // / /    / / // / /   / / // / /_____/ /\ \\ \ \   ]],
    [[/ / /    / / // / /___/ / // / /    / / / \ \ \__/ / // /_________/\ \ \\ \ \  ]],
    [[\/_/    / / // / /____\/ // / /    / / /   \ \___\/ // / /_       __\ \_\\ \_\ ]],
    [[        \/_/ \/_________/ \/_/     \/_/     \/_____/ \_\___\     /____/_/ \/_/ ]],
  },
  wednesday = {
    [[        _   _         _            _             _            _    _        _  ]],
    [[       /\_\/\_\ _    /\ \         /\ \     _    /\ \         / /\ /\ \     /\_\]],
    [[      / / / / //\_\ /  \ \       /  \ \   /\_\ /  \ \____   / /  \\ \ \   / / /]],
    [[     /\ \/ \ \/ / // /\ \ \     / /\ \ \_/ / // /\ \_____\ / / /\ \\ \ \_/ / / ]],
    [[    /  \____\__/ // / /\ \ \   / / /\ \___/ // / /\/___  // / /\ \ \\ \___/ /  ]],
    [[   / /\/________// / /  \ \_\ / / /  \/____// / /   / / // / /  \ \ \\ \ \_/   ]],
    [[  / / /\/_// / // / /   / / // / /    / / // / /   / / // / /___/ /\ \\ \ \    ]],
    [[ / / /    / / // / /   / / // / /    / / // / /   / / // / /_____/ /\ \\ \ \   ]],
    [[/ / /    / / // / /___/ / // / /    / / / \ \ \__/ / // /_________/\ \ \\ \ \  ]],
    [[\/_/    / / // / /____\/ // / /    / / /   \ \___\/ // / /_       __\ \_\\ \_\ ]],
    [[        \/_/ \/_________/ \/_/     \/_/     \/_____/ \_\___\     /____/_/ \/_/ ]],
  },
  thursday = {
    [[        _   _         _            _             _            _    _        _  ]],
    [[       /\_\/\_\ _    /\ \         /\ \     _    /\ \         / /\ /\ \     /\_\]],
    [[      / / / / //\_\ /  \ \       /  \ \   /\_\ /  \ \____   / /  \\ \ \   / / /]],
    [[     /\ \/ \ \/ / // /\ \ \     / /\ \ \_/ / // /\ \_____\ / / /\ \\ \ \_/ / / ]],
    [[    /  \____\__/ // / /\ \ \   / / /\ \___/ // / /\/___  // / /\ \ \\ \___/ /  ]],
    [[   / /\/________// / /  \ \_\ / / /  \/____// / /   / / // / /  \ \ \\ \ \_/   ]],
    [[  / / /\/_// / // / /   / / // / /    / / // / /   / / // / /___/ /\ \\ \ \    ]],
    [[ / / /    / / // / /   / / // / /    / / // / /   / / // / /_____/ /\ \\ \ \   ]],
    [[/ / /    / / // / /___/ / // / /    / / / \ \ \__/ / // /_________/\ \ \\ \ \  ]],
    [[\/_/    / / // / /____\/ // / /    / / /   \ \___\/ // / /_       __\ \_\\ \_\ ]],
    [[        \/_/ \/_________/ \/_/     \/_/     \/_____/ \_\___\     /____/_/ \/_/ ]],
  },
  friday = {
    [[        _   _         _            _             _            _    _        _  ]],
    [[       /\_\/\_\ _    /\ \         /\ \     _    /\ \         / /\ /\ \     /\_\]],
    [[      / / / / //\_\ /  \ \       /  \ \   /\_\ /  \ \____   / /  \\ \ \   / / /]],
    [[     /\ \/ \ \/ / // /\ \ \     / /\ \ \_/ / // /\ \_____\ / / /\ \\ \ \_/ / / ]],
    [[    /  \____\__/ // / /\ \ \   / / /\ \___/ // / /\/___  // / /\ \ \\ \___/ /  ]],
    [[   / /\/________// / /  \ \_\ / / /  \/____// / /   / / // / /  \ \ \\ \ \_/   ]],
    [[  / / /\/_// / // / /   / / // / /    / / // / /   / / // / /___/ /\ \\ \ \    ]],
    [[ / / /    / / // / /   / / // / /    / / // / /   / / // / /_____/ /\ \\ \ \   ]],
    [[/ / /    / / // / /___/ / // / /    / / / \ \ \__/ / // /_________/\ \ \\ \ \  ]],
    [[\/_/    / / // / /____\/ // / /    / / /   \ \___\/ // / /_       __\ \_\\ \_\ ]],
    [[        \/_/ \/_________/ \/_/     \/_/     \/_____/ \_\___\     /____/_/ \/_/ ]],
  },
  saturday = {
    [[        _   _         _            _             _            _    _        _  ]],
    [[       /\_\/\_\ _    /\ \         /\ \     _    /\ \         / /\ /\ \     /\_\]],
    [[      / / / / //\_\ /  \ \       /  \ \   /\_\ /  \ \____   / /  \\ \ \   / / /]],
    [[     /\ \/ \ \/ / // /\ \ \     / /\ \ \_/ / // /\ \_____\ / / /\ \\ \ \_/ / / ]],
    [[    /  \____\__/ // / /\ \ \   / / /\ \___/ // / /\/___  // / /\ \ \\ \___/ /  ]],
    [[   / /\/________// / /  \ \_\ / / /  \/____// / /   / / // / /  \ \ \\ \ \_/   ]],
    [[  / / /\/_// / // / /   / / // / /    / / // / /   / / // / /___/ /\ \\ \ \    ]],
    [[ / / /    / / // / /   / / // / /    / / // / /   / / // / /_____/ /\ \\ \ \   ]],
    [[/ / /    / / // / /___/ / // / /    / / / \ \ \__/ / // /_________/\ \ \\ \ \  ]],
    [[\/_/    / / // / /____\/ // / /    / / /   \ \___\/ // / /_       __\ \_\\ \_\ ]],
    [[        \/_/ \/_________/ \/_/     \/_/     \/_____/ \_\___\     /____/_/ \/_/ ]],
  },
  sunday = {
    [[        _   _         _            _             _            _    _        _  ]],
    [[       /\_\/\_\ _    /\ \         /\ \     _    /\ \         / /\ /\ \     /\_\]],
    [[      / / / / //\_\ /  \ \       /  \ \   /\_\ /  \ \____   / /  \\ \ \   / / /]],
    [[     /\ \/ \ \/ / // /\ \ \     / /\ \ \_/ / // /\ \_____\ / / /\ \\ \ \_/ / / ]],
    [[    /  \____\__/ // / /\ \ \   / / /\ \___/ // / /\/___  // / /\ \ \\ \___/ /  ]],
    [[   / /\/________// / /  \ \_\ / / /  \/____// / /   / / // / /  \ \ \\ \ \_/   ]],
    [[  / / /\/_// / // / /   / / // / /    / / // / /   / / // / /___/ /\ \\ \ \    ]],
    [[ / / /    / / // / /   / / // / /    / / // / /   / / // / /_____/ /\ \\ \ \   ]],
    [[/ / /    / / // / /___/ / // / /    / / / \ \ \__/ / // /_________/\ \ \\ \ \  ]],
    [[\/_/    / / // / /____\/ // / /    / / /   \ \___\/ // / /_       __\ \_\\ \_\ ]],
    [[        \/_/ \/_________/ \/_/     \/_/     \/_____/ \_\___\     /____/_/ \/_/ ]],
  },
}

M.fn_menu = {}

function M.fn_menu.files() end
function M.fn_menu.projects() end
function M.fn_menu.recent_files() end
function M.fn_menu.grep() end
function M.fn_menu.git() end

function M.fn_menu.tip() end

function M.fn_menu.apc() end

function M.fn_menu.edit(path) end

return M
